# Grafana数据多轮对话分析 - 全场景测试文档

## 🎯 测试目标
基于真实Grafana Play数据源，验证进阶版本在复杂多轮对话场景下的数据获取、分析、上下文管理能力。

## 📊 真实数据源
- **数据源**: https://play.grafana.org
- **狗狗币OHLC数据**: 面板2和面板7的K线数据
- **CPU使用率数据**: 系统性能监控数据

## 🧪 多轮对话复杂场景测试

### 场景1：dogecoin_panel_2数据获取与分析分离
**测试步骤**：
1. 输入：`帮我获取dogecoin_panel_2的数据`
2. 验证：AI获取dogecoin_panel_2数据但不立即分析
3. 输入：`现在分析一下这个K线数据的趋势`
4. 验证：AI基于已获取的OHLC数据进行分析
5. 输入：`这个分析不够深入，再详细分析一下支撑位和阻力位`
6. 验证：AI在已有数据基础上深入分析技术指标

### 场景2：多数据源交叉分析
**测试步骤**：
1. 输入：`获取dogecoin_panel_2和dogecoin_panel_7的数据`
2. 验证：AI获取两个不同面板的狗狗币数据
3. 输入：`对比分析这两个面板的数据差异`
4. 验证：AI进行交叉对比分析
5. 输入：`哪个面板的数据更准确？`
6. 验证：AI基于对比结果判断数据质量
7. 输入：`如果数据有差异，可能是什么原因？`
8. 验证：AI基于上下文进行根因分析

### 场景3：长时间对话上下文保持
**测试步骤**：
1. 输入：`分析dogecoin_panel_2市场表现`
2. 输入：`这个开盘价和收盘价差距很大啊`
3. 输入：`成交量数据怎么样？`
4. 输入：`对比一下价格和成交量的关系`
5. 输入：`这个趋势持续多久了？`
6. 输入：`如果继续这样会有什么影响？`
7. 输入：`有什么投资建议？`
8. 验证：AI在整个对话中保持上下文连贯性

### 场景4：数据源动态切换与缓存
**测试步骤**：
1. 输入：`分析dogecoin_panel_2的数据`
2. 输入：`再分析dogecoin_panel_7的数据`
3. 输入：`回到dogecoin_panel_2，刚才那个最高价是多少？`
4. 验证：AI正确切换回dogecoin_panel_2数据，使用缓存
5. 输入：`dogecoin_panel_2和dogecoin_panel_7的数据有关系吗？`
6. 验证：AI结合两个面板数据源进行关联分析

### 场景5：复杂自然语言理解
**测试步骤**：
1. 输入：`帮我看看dogecoin_panel_2的整体市场状况，重点关注价格趋势和成交量变化`
2. 验证：AI理解复杂需求，获取OHLC数据
3. 输入：`这个市场看起来有点波动，你觉得呢？`
4. 验证：AI基于数据判断市场状态
5. 输入：`如果我想投资狗狗币，应该关注哪些指标？`
6. 验证：AI提供基于数据的投资建议

### 场景6：多轮深入分析
**测试步骤**：
1. 输入：`分析dogecoin_panel_2的OHLC数据`
2. 输入：`这个价格峰值是什么时候出现的？`
3. 输入：`能分析一下这个时间段的详细数据吗？`
4. 输入：`这个价格模式有什么特点？`
5. 输入：`如果这个趋势持续，会有什么影响？`
6. 输入：`有什么技术指标可以预测这个趋势？`
7. 验证：AI在每轮对话中深入分析，保持逻辑连贯

### 场景7：数据对比与趋势分析
**测试步骤**：
1. 输入：`获取dogecoin_panel_2最近1小时的数据`
2. 输入：`再获取dogecoin_panel_2最近24小时的数据`
3. 输入：`对比这两个时间段的数据`
4. 输入：`1小时内的波动在24小时中算什么水平？`
5. 输入：`这个趋势是偶然的还是持续的？`
6. 输入：`预测一下接下来1小时会怎么样？`
7. 验证：AI进行多时间维度的对比和趋势分析

### 场景8：系统性能与加密货币关联分析
**测试步骤**：
1. 输入：`分析overall_cpu_utilization100数据`
2. 验证：AI获取overall_cpu_utilization100数据
3. 输入：`这个CPU使用率和dogecoin_panel_2交易有关系吗？`
4. 验证：AI尝试关联系统性能和加密货币数据
5. 输入：`如果CPU使用率高，会影响交易系统吗？`
6. 验证：AI基于数据提供系统影响分析

### 场景9：多用户场景模拟
**测试步骤**：
1. 输入：`分析dogecoin_panel_2市场数据`
2. 输入：`我是技术分析师，需要关注哪些技术指标？`
3. 输入：`从投资者角度，这个价格走势如何？`
4. 输入：`作为风险管理者，这个波动率风险如何？`
5. 验证：AI根据不同角色提供相应角度的分析

### 场景10：复杂决策支持
**测试步骤**：
1. 输入：`dogecoin_panel_2市场分析`
2. 输入：`如果价格突破0.5美元，应该买入吗？`
3. 输入：`买入的成本和收益如何？`
4. 输入：`有其他投资策略吗？`
5. 输入：`基于当前数据，你建议采取什么行动？`
6. 验证：AI提供基于数据的投资决策支持

### 场景11：错误恢复与数据重获取
**测试步骤**：
1. 输入：`分析dogecoin_panel_2数据`
2. 模拟网络错误或数据获取失败
3. 输入：`刚才的数据有问题，重新获取一下`
4. 验证：AI重新获取数据
5. 输入：`现在数据正常了吗？`
6. 验证：AI确认数据质量并继续分析

### 场景12：跨数据源综合分析
**测试步骤**：
1. 输入：`获取dogecoin_panel_2和overall_cpu_utilization100数据`
2. 输入：`这两个数据源有什么关联？`
3. 输入：`如果CPU使用率高，会影响dogecoin_panel_2交易吗？`
4. 输入：`基于这两个数据，系统运行状况如何？`
5. 验证：AI进行跨数据源的综合分析

## ✅ 验证要点

### 多轮对话能力
- [ ] 上下文保持完整
- [ ] 指代词理解正确（"这个"、"那个"）
- [ ] 对话逻辑连贯
- [ ] 历史信息复用

### 数据管理能力
- [ ] 多数据源并行管理（dogecoin_panel_2, dogecoin_panel_7, overall_cpu_utilization100）
- [ ] 缓存机制有效
- [ ] 数据获取与分析分离
- [ ] 数据质量验证

### 智能分析能力
- [ ] 复杂自然语言理解
- [ ] 多维度数据对比
- [ ] 趋势预测分析
- [ ] 根因分析能力

### 用户体验
- [ ] 响应时间合理
- [ ] 错误恢复机制
- [ ] 角色化分析
- [ ] 决策支持能力

## 🚀 测试执行

```bash
# 1. 构建项目
npm run build

# 2. 启动服务器
CONFIG_PATH=./config/grafana-config-play.js node dist/main.js

# 3. 在Cursor IDE中按顺序测试上述场景
```

## 📊 测试结果记录

| 场景 | 上下文保持 | 数据管理 | 智能分析 | 用户体验 | 备注 |
|------|------------|----------|----------|----------|------|
| dogecoin_panel_2数据获取与分析分离 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 多数据源交叉分析 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 长时间对话上下文保持 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 数据源动态切换与缓存 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 复杂自然语言理解 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 多轮深入分析 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 数据对比与趋势分析 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 系统性能与加密货币关联分析 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 多用户场景模拟 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 复杂决策支持 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 错误恢复与数据重获取 | ⬜ | ⬜ | ⬜ | ⬜ | |
| 跨数据源综合分析 | ⬜ | ⬜ | ⬜ | ⬜ | |

## 🎯 通过标准
- 所有多轮对话场景测试通过
- 上下文保持率 > 95%
- 数据管理准确率 > 90%
- 智能分析准确率 > 85%
- 用户体验满意度 > 90%

## 📈 真实数据特点
- **狗狗币OHLC数据**: 包含开盘价、最高价、最低价、收盘价、成交量
- **时间范围**: 2021-07-13 到 2021-07-13 (约3.6小时数据)
- **数据点**: 1150个数据点
- **CPU使用率**: 实时系统性能监控数据
- **数据源**: Grafana Play演示环境 